<div class="meta-table-options">
    <button (click)="deleteSelectedItems()">Delete</button>
    <input #filterSearch type="text" placeholder="Filter" [(ngModel)]="filterText" (keyup)="filterRows($event)">
    <button (click)="toggleTableOptionsDisplay()">
        <fa-icon [icon]="faCog" size="xs"></fa-icon>
    </button>
</div>

<table>
    <thead>
        <th><input #selectAllCheckbox type="checkbox" [indeterminate]="anyRowSelected()" (change)="toggleAllRows()"></th>
        <ng-container *ngFor="let column of columnDisplayOrder">
            <th *ngIf="shownItems[column.fieldName]">{{ column.columnName }}</th>
        </ng-container>
    </thead>
    <tr *ngFor="let product of filteredProductList; let i = index" [attr.data-index]="i">
      <td *ngIf="showCheckbox()">
          <input #rowCheckboxes type="checkbox" (change)="toggleRowSelected(i)">
      </td>
      <ng-container *ngFor="let column of columnDisplayOrder">
          <td *ngIf="shownItems[column.fieldName]">
              <ng-container [ngSwitch]="column.fieldName">
                <span *ngSwitchCase="'postedDate'">{{ product[column.fieldName] | date : 'MM/dd/yyyy' }}</span>
                <a *ngSwitchCase="'imageUrl'" href="{{ product.imageUrl }}">{{ product[column.fieldName] }}</a>
                <span *ngSwitchDefault>{{ product[column.fieldName] }}</span>
              </ng-container>
            </td>
      </ng-container>
    </tr>
  </table>

<a routerLink="/add-product">Add item</a>

<div [ngClass]="{'hide-table-options': !displayTableOptions}">
    <div
    class="draggable-column-names"
    draggable="true" 
    *ngFor="let column of columnDisplayOrder; let i = index;"
    [id]="'column-index-' + i"
    (dragstart)="handleDragStart($event)"
    (dragenter)="handleDrag($event)"
    (dragleave)="handleDrag($event)"
    (dragover)="handleDrag($event)"
    (drop)="handleDrag($event, i)">
        <fa-icon [icon]="faBars" size="xs"></fa-icon>
        <input type="checkbox" checked name="{{ column.fieldName }}" id="{{ column.fieldName }}" [(ngModel)]="shownItems[column.fieldName]">
        <label for="{{ column.fieldName }}">{{ column.columnName }}</label>
    </div>
    <button (click)="resetColumnOrder()">Reset to Default</button>
</div>
